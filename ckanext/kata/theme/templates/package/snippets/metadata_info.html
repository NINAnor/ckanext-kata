<section class="module-content additional-info">
<h3>{{ _('General information') }}</h3>
{% if pkg_dict.language or pkg_dict.langdis %}
<table class="table table-striped table-bordered table-condensed">
     <tbody>
	<tr>
		<th class="dataset-label">{{ _('Language') }}</th>
		<td class="dataset-details">{% if pkg_dict.language != 'None' %}{{pkg_dict.language}}{% else %}{{ _('No language') }}{% endif%}</td>
	</tr>
	</tbody>
</table>
{% endif %}
{% if pkg_dict.langtitle %}
<h4>{{ _('Titles') }}</h4>
<table class="table table-striped table-bordered table-condensed">
	<tbody>
	<tr>
		<th>{{ _('Title') }}</th>
		<th>{{ _('Language') }}</th>
	</tr>
	{% for langtitle in pkg_dict.langtitle %}
	<tr>
		<td>{{ langtitle.value }}</td>
		<td>{{ langtitle.lang }}</td>
	</tr>
	{% endfor %}
	</tbody>
</table>
{% endif %}
{% if pkg_dict.agent %}
<h4>{{ _('Agents')}}</h4>
{% set nme = true if h.has_agents_name(pkg_dict) %}
{% set org = true if h.has_agents_organisation(pkg_dict) %}
{% set url = true if h.has_agents_url(pkg_dict) %}
{% set fid = true if h.has_agents_funding_id(pkg_dict) %}
<table class="table table-striped table-bordered table-condensed">
	<tbody>
	<tr>
		<th>{{ _('Role') }}</th>
		{% if nme %}<th>{{ _('Name') }}</th>{% endif%}
		{% if org %}<th>{{ _('Organisation') }}</th>{% endif%}
		{% if url %}<th>{{ _('URL') }}</th>{% endif%}
		{% if fid %}<th>{{ _('Funding id') }}</th>{% endif%}
	</tr>
	{% for agent in pkg_dict.agent %}
	<tr>
		<td>{{ h.resolve_agent_role(agent.role) }}</td>
		{% if nme %}<td>{{ agent.name }}</td>{% endif%}
		{% if org %}<td>{{ agent.organisation }}</td>{% endif%}
		{% if url %}<td>{{ agent.URL }}</td>{% endif%}
		{% if fid %}<td>{{ agent['funding-id'] }}</td>{% endif%}
	</tr>
	{% endfor %}
	</tbody>
</table>
{% endif %}
</section>
<section class="module-content">
<h3>{{ _('Description') }}</h3>
  {% if not pkg_notes_formatted == '' %}
    <div class="notes embedded-content">
      {{ pkg_notes_formatted }}
    </div>
  {% else %}
  <p>{{ _('No description') }}</p>
  {% endif%}
</section>
{% block package_tags %}
	{% if pkg_dict.tags %}<h3 class="module-content">{{ _('Keywords') }}</h3>{% endif %}
	{% snippet "package/snippets/tags.html", tags=pkg_dict.tags %}
{% endblock %}
<section class="module-content additional-info">
<h3>{{ _('Usage information') }}</h3>
<div class="info-block{{ ' info-inline' if inline }}{{ " " ~ classes | join(' ') }}">
{{ _('This dataset is') }}
{% if pkg_dict.availability == 'access_application' %}{{ _(' available via an access form in ') }}<a href="{{ pkg_dict.access_application_URL }}" target="_blank" class="download icon-external-link">{{ _('this link')}}</a> {% endif%}
{% if pkg_dict.availability == 'direct_download' %}{{ _(' available freely ') }}{% if pkg_dict.direct_download_URL %} <a href="{{pkg_dict.direct_download_URL}}" class="download">{{ _('from this address') }}</a> {% endif %} {% endif %}
{% if pkg_dict.availability == 'access_request' %}{{ _(' available via login ') }}{% if pkg_dict.access_request_URL %} <a href="{{pkg_dict.access_request_URL}}" class="download">{{ _('from this address') }}</a> {% endif %} {% endif %}
{% if pkg_dict.availability == 'contact_owner' %}
    {{ _(' available by ') -}} {% link_for _('contacting the distributor'), controller='ckanext.kata.controllers:ContactController', action='render_request', pkg_id=pkg_dict.id, class_='download' %}
{% endif %}
{% if pkg_dict.availability == 'through_provider' %}{{ _(' available through ') }}<a href="{{pkg_dict.through_provider_URL}}" class="download">{{ _('data provider') }}</a> {% endif %}
{% if not pkg_dict.availability %}{{ _(' available freely or availability is not specified') }}{% endif %}

{% if pkg_dict.license_title %}{{ _(' with license as ') }}{{pkg_dict.license_title}}
    {%- if pkg_dict.license_URL %}, {{pkg_dict.license_URL}}
    {%- endif -%}
{%- endif %}
</div>
</section>
<section class="module-content additional-info">
<h3>{{ _('Contact information') }}</h3>
{% if pkg_dict.maintainer %}
<h4>{{ _('Primary contact') }}</h4>
<table class="table table-striped table-bordered table-condensed">
	<tbody>
	<tr>
		<th class="dataset-label">{{ _('Name') }}</th>
		<td class="dataset-details">{{ pkg_dict.maintainer }}</td>
	</tr>
	<tr>
		<th class="dataset-label">{{ _('Phone') }}</th>
		{% if pkg_dict.contact_phone|length > 0 %}
		    <td class="dataset-details">tel:{{ pkg_dict.contact_phone }}</td>
		{% else %}
		    <td class="dataset-details"></td>
		{% endif %}
	</tr>
	<tr>
		<th class="dataset-label">{{ _('Email') }}</th>
		{# only show the maintainer email directly to users who have admin privileges to the metadata #}
		{% if h.check_access('package_update', {'id':pkg_dict.id }) %}
			<td class="dataset-details">mailto:{{ pkg_dict.maintainer_email}}</td>
		{% else %}
			<td class="dataset-details">
				{% link_for _('Send a message'), controller='ckanext.kata.controllers:ContactController', action='render_contact', pkg_id=pkg_dict.id %}
			</td>
		{% endif %}
	</tr>
	<tr>
		<th class="dataset-label">{{ _('Homepage') }}</th>
		<td class="dataset-details"><a href="{{ pkg_dict.contact_URL }}">{{ pkg_dict.contact_URL }}</a></td>
	</tr>
	</tbody>
</table>
{% endif%}
</section>
<section class="module-content additional-info">
  <h3>{{ _('Identification information') }}</h3>
  {% if pkg_dict.version %}
    <h4>{{ _('Last modification time of data') }}</h4>
    <table class="table table-striped table-bordered table-condensed">
      <tr>
        <th class="dataset-label">{{ _('Last modified') }}</th>
        <td class="dataset-details">{{pkg_dict.version}}</td>
      </tr>
    </table>
  {% endif %}
  <h4>{{ _('Permanent identifiers') }}</h4>
  <table class="table table-striped table-bordered table-condensed">
    <tr>
      <th class="dataset-label">{{ _('Primary metadata identifier') }}</th>
      <td class="dataset-details">{{pkg_dict.id}}</td>
    </tr>
    <tr>
      <th class="dataset-label">{{ _('Primary data identifier') }}</th>
      <td class="dataset-details">{{pkg_dict.name}}</td>
    </tr>
    {% for pid in pkg_dict.pids %}
      <tr>
        <th class="dataset-label">{{ _(pid.get('type').capitalize() + ' identifier') }}</th>
        <td class="dataset-details">{{pid.id}}</td>
      </tr>
    {% endfor %}
  </table>
</section>
<section class="module-content additional-info">
<h3>{{ _('Additional information on dataset') }}</h3>
<table class="table table-striped table-bordered table-condensed">
{% if pkg_dict.geographic_coverage %}
<tr>
	<th class="dataset-label">{{ _('Geographical areas covered') }}</th>
	<td class="dataset-details">{{pkg_dict.geographic_coverage}}</td>
</tr>
{% endif %}
{% if pkg_dict.temporal_coverage_begin and pkg_dict.temporal_coverage_end %}
<tr>
	<th class="dataset-label">{{ _('Period of time covered') }}</th>
	<td class="dataset-details">{{pkg_dict.temporal_coverage_begin}}{{_(' to ') }}{{pkg_dict.temporal_coverage_end}}</td>
</tr>
{% endif %}
{% if pkg_dict.publications %}
<tr>
	<td>{{ _('Publications based on this data') }}</td>
	<td>{{pkg_dict.publications}}</td>
</tr>
{% endif %}
{% if pkg_dict.collections %}
<tr>
	<th class="dataset-label">{{ _('Dataset belongs to collection/series') }}</th>
	<td class="dataset-details">{{pkg_dict.collections}}</td>
</tr>
{% endif %}
{% if pkg_dict.erelated %}
<tr>
	<th class="dataset-label">{{ _('Other related datasets') }}</th>
	<td class="dataset-details">{{pkg_dict.erelated}}</td>
</tr>
{% endif %}
{% if pkg_dict.discipline %}
<tr>
	<th class="dataset-label">{{ _('Discipline/branch of science') }}</th>
	<td class="dataset-details">{{pkg_dict.discipline}}</td>
</tr>
{% endif %}
{% if pkg_dict.mimetype %}
<tr>
	<th class="dataset-label">{{ _('File format') }}</th>
	<td class="dataset-details">{{pkg_dict.mimetype}}</td>
</tr>
{% endif %}
{% if pkg_dict.algorithm and pkg_dict.checksum %}
<tr>
	<th class="dataset-label">{{ _('Checksum') }}</th>
	<td class="dataset-details">{{pkg_dict.checksum}}</td>
</tr>
<tr>
	<th class="dataset-label">{{ _('Algorithm') }}</th>
	<td class="dataset-details">{{pkg_dict.algorithm}}</td>
</tr>
{% endif %}

</table>
</section>
{% if pkg_dict.events %}
<section class="module-content additional-info">
<h3>{{ _('Dataset lifecycle events') }}</h3>
<table class="table table-striped table-bordered table-condensed">
    <colgroup>
        <col width="25%">
        <col width="25%">
        <col width="25%">
        <col width="25%">
    </colgroup>
	<tr>
		<th>{{ _('Type') }}</th>
		<th>{{ _('Who') }}</th>
		<th>{{ _('Date') }}</th>
		<th>{{ _('Description') }}</th>
	</tr>
	{% for type, who, when, descr in pkg_dict.events %}
	<tr>
		<td class="dataset-details">{{ _(type.value) }}</td>
		<td class="dataset-details">{{who.value}}</td>
		<td class="dataset-details">{{when.value}}</td>
		<td class="dataset-details">{{descr.value}}</td>
	</tr>
    {% endfor %}
</table>
</section>
{% endif %}
