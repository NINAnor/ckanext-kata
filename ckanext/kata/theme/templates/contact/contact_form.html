{% extends "page.html" %}

{% block content %}

<div id="etsin-main">
  <div class="etsin-container read-base-container">
    <div class="container container-small">
      {% block flash %}
        {{ super() }}
      {% endblock %}
      <div class="row-fluid">
        {%- block inner_content %}

          <div class="dataset-view-content">
            <h2 class="page-title">{{ _('Contact distributor') }}</h2>
            <div class="dataset-section form-tab-content">

             {% block contact_form %}
               {% set form_post_url = h.url_for(controller='ckanext.kata.controllers:ContactController', action='send_contact_message', pkg_id=c.package.id) %}
               <form class="dataset-form form-horizontal" method="post" action={{form_post_url}} data-module="basic-form">
                 {#<p>{{ _("On this page you can send a message to the owner of the dataset.") }}</p>#}

                 <label for="contact-recipient">{{ _("Recipient") }}</label>
                 <select id="contact-recipient" name="recipient">
                   {% for recipient in c.recipient_options %}
                     <option value="{{ recipient.value }}" {% if loop.index0|string == c.recipient_index %}selected{% endif %}>{{ recipient.text }}</option>
                   {% endfor %}
                 </select>
                 <label for="msg">{{ _("Message") }}</label>
                 <textarea name="msg" rows="10" cols="50"></textarea>
                 <label for="from_address">{{ _("Reply address") }}</label>
                 {% set from = "" %}
                 {% if c.userobj %}
                   {% set from = c.userobj.email %}
                 {% endif %}
                 <input type="email" name="from_address" value="{{ from }}">
                 <label for="from_name">{{ _("Reply (your) name") }}</label>
                 <input type="text" name="from_name">
                 <input type="hidden" name="check_this_out" value="{{ c.current_time }}">
                 <div class="hidden">
                   <label for="hp">{{ _('Leave this unchecked') }}</label>
                   <input type="checkbox" name="hp">
                 </div>
                 <br />
                 <label for="accept-rules">{{ _('I understand that by sending this form details like time, message and IP will be logged by the service to prevent abuse.') }}</label>
                 <input type="checkbox" name="accept_logging">
                 <br /><br />
                 <p><input type="submit" value="{{ _('Send') }}" class="btn btn-success"/></p>
               </form>
             {% endblock %}
            </div>
          </div>

        {% endblock -%}
      </div>
    </div>
  </div>
</div>

{% endblock %}
